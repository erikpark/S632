knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(ggplot2)
library(faraway)
library(dplyr)
library(pscl)
turtles <- turtle
View(turtles)
m1 <- glm((male)/(male+female) ~ temp, family = binomial, turtles)
m2 <- glm((male)/(male+female) ~ temp + I(temp^2), family = binomial, turtles)
turtles2 <- turtles %>% group_by(temp) %>% summarise_all(funs(sum(.)))
turtles2 <- turtles2[,-4]
View(turtles2)
turtles2 <- turtles %>% group_by(temp) %>% summarise_all(funs(sum(.)))
m3 <- glm((male)/(male+female) ~ temp, family = binomial, turtles2)
summary(m3)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
pchisq(8.0484 - 2.6120, 1, lower = FALSE)
pchisq(deviance(m3), df.residual(m3), lower = FALSE)
pchisq(2.34319, 4, lower = FALSE)
pchisq(deviance(m1), df.residual(m1), lower = FALSE)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
pchisq(deviance(m3), df.residual(m3), lower = FALSE)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
pchisq(deviance(m3), df.residual(m3), lower = FALSE)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
summary(m1)
summary(m3)
pchisq(0.56576 - 2.6120, -10, lower = FALSE)
pchisq(0.56576 - 2.6120, 10, lower = FALSE)
anova(m3,m1)
sigma2 <- sum(residuals(m1, type = pearson)^2/13)
sigma2 <- sum(residuals(m1, type = "pearson")^2/13)
sum(residuals(m1, type = "pearson")^2/13)
sum(residuals((m1, type = "pearson")^2)/13)
sum(residuals(m1, type = "pearson")^2/13)
sum(residuals(m1, type = "pearson")^2/12)
sum(residuals(m1, type = "pearson")^2/13)
cbind(male,femal)
cbind(male,female, data = turtles)
attach(turtles)
cbind(male,female)
xtabs
xtabs(cbind(male,female))
?xtabs
?cbind
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(ggplot2)
library(faraway)
library(dplyr)
library(pscl)
library(alr4)
disco <- discoveries
plot.ts(disco)
mean(disco)
m1 <- glm(disco ~ 1, family = poisson)
exp(m1$coefficients)
1-pchisq(deviance(m1),df.residual(m1))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(ggplot2)
library(faraway)
library(dplyr)
library(pscl)
library(alr4)
disco <- discoveries
plot.ts(disco)
mean(disco)
m1 <- glm(disco ~ 1, family = poisson)
exp(m1$coefficients)
1-pchisq(deviance(m1),df.residual(m1))
t1 <- table(disco)
t1 <- as.data.frame(t1)
sum(t1[9:12,]$Freq)
t2 <- c(8,4)
t1 <- rbind(t1,t2)
t1 <- t1[-(9:12),]
expected <- c(dpois(0:7,3.1)*100, ppois(7,3.1,lower.tail = FALSE)*100)
te <- as.data.frame(expected)
colnames(te) <- "Freq"
te$disco <- c(0,1,2,3,4,5,6,7,8)
combined <- rbind(t1,te)
combined$source <- rep(c("observed","expected"), each = 9)
ggplot(combined, aes(x = disco, y = Freq, fill = source)) + geom_col(position = position_dodge())
?geom_boxplot
library(ggplot2)
?geom_boxplot
latexmk
?latexmk
??latexmk
version
packageStatus()
knit_with_parameters('/media/removable/USB Drive/Spring 18/S632/Homework/HW6.Rmd')
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
mnull <- lm(waste ~ 1, denim)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(alr4)
library(ggplot2)
library(faraway)
library(lme4)
library(RLRsim)
library(lattice)
denim <- denim
ggplot(denim, aes(x= supplier, y = waste)) + geom_boxplot()
m1 <- lm(waste ~ supplier, data = denim)
Anova(m1)
summary(denim)
mnull <- lm(waste ~ 1, denim)
m2 <- lmer(waste ~ 1 + (1|supplier), denim, REML = FALSE)
summary(m2)
lr.1 <- as.numeric(2*(logLik(m2)-logLik(mnull)))
# Parametric bootstrapping method
y <- simulate(mnull) #Simulate from the distribution under the null
lrstat <- numeric(1000)
set.seed(142)
for(i in 1:1000){
y <- unlist(simulate(mnull))
bnull <- lm(y ~ 1)
balt <- lmer(y ~ 1 + (1|supplier), denim, REML=FALSE)
lrstat[i] <- as.numeric(2*(logLik(balt)-logLik(bnull)))
}
phat = mean(lrstat > lr.1)
phat
m3 <- lmer(waste ~ 1 + (1|supplier), denim)
exactRLRT(m3) #use exactRLRT for models obtained with REML
dotplot(ranef(m3, condVar=TRUE))
for(i in 1:1000){
y <- unlist(simulate(mnull))
bnull <- lm(y ~ 1)
balt <- lmer(y ~ 1 + (1|supplier), denim, REML=FALSE)
lrstat[i] <- as.numeric(2*(logLik(balt)-logLik(bnull)))
}
phat = mean(lrstat > lr.1)
phat
lmod <- aov(waste ~ supplier, denim)
cc <- model.tables(lmod)
cc[[1]]$supplier/ranef(m3)$supplier
ranef(m3)$supplier
breaking <- breaking
ggplot(breaking, aes(y=y,x=operator, color=day, shape=supplier)) + geom_point()
m1 <- lm(y ~ operator + day + supplier, breaking)
Anova(m1)
m2 <- lmer(y ~ supplier + (1|operator) + (1|day), breaking)
sumary(m2)
m2 <- lmer(y ~ supplier + (1|operator) + (1|day), breaking)
m3 <- lmer(y ~ supplier + (1|operator), breaking)
m4 <- lmer(y ~ supplier + (1|day), breaking)
exactRLRT(m3,m2,m4)
exactRLRT(m4,m2,m3)
mnull <- lm(y ~ supplier, breaking)
m2 <- lmer(y ~ supplier + (1|operator) + (1|day), breaking, REML = FALSE)
lr.1 <- as.numeric(2*(logLik(m2)-logLik(mnull)))
y <- simulate(mnull) #Simulate from the distribution under the null
lrstat <- numeric(1000)
set.seed(142)
for(i in 1:1000){
y <- unlist(simulate(mnull))
bnull <- lm(y ~ 1)
balt <- lmer(y ~ supplier + (1|day) + (1|operator), breaking, REML = FALSE)
lrstat[i] <- as.numeric(2*(logLik(balt)-logLik(bnull)))
}
