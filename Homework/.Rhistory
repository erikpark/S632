knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(ggplot2)
library(faraway)
library(dplyr)
library(pscl)
turtles <- turtle
View(turtles)
m1 <- glm((male)/(male+female) ~ temp, family = binomial, turtles)
m2 <- glm((male)/(male+female) ~ temp + I(temp^2), family = binomial, turtles)
turtles2 <- turtles %>% group_by(temp) %>% summarise_all(funs(sum(.)))
turtles2 <- turtles2[,-4]
View(turtles2)
turtles2 <- turtles %>% group_by(temp) %>% summarise_all(funs(sum(.)))
m3 <- glm((male)/(male+female) ~ temp, family = binomial, turtles2)
summary(m3)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
pchisq(8.0484 - 2.6120, 1, lower = FALSE)
pchisq(deviance(m3), df.residual(m3), lower = FALSE)
pchisq(2.34319, 4, lower = FALSE)
pchisq(deviance(m1), df.residual(m1), lower = FALSE)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
pchisq(deviance(m3), df.residual(m3), lower = FALSE)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
pchisq(deviance(m3), df.residual(m3), lower = FALSE)
pchisq(2.34319 - 0.56576, 1, lower = FALSE)
summary(m1)
summary(m3)
pchisq(0.56576 - 2.6120, -10, lower = FALSE)
pchisq(0.56576 - 2.6120, 10, lower = FALSE)
anova(m3,m1)
sigma2 <- sum(residuals(m1, type = pearson)^2/13)
sigma2 <- sum(residuals(m1, type = "pearson")^2/13)
sum(residuals(m1, type = "pearson")^2/13)
sum(residuals((m1, type = "pearson")^2)/13)
sum(residuals(m1, type = "pearson")^2/13)
sum(residuals(m1, type = "pearson")^2/12)
sum(residuals(m1, type = "pearson")^2/13)
cbind(male,femal)
cbind(male,female, data = turtles)
attach(turtles)
cbind(male,female)
xtabs
xtabs(cbind(male,female))
?xtabs
?cbind
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(ggplot2)
library(faraway)
library(dplyr)
library(pscl)
library(alr4)
disco <- discoveries
plot.ts(disco)
mean(disco)
m1 <- glm(disco ~ 1, family = poisson)
exp(m1$coefficients)
1-pchisq(deviance(m1),df.residual(m1))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(ggplot2)
library(faraway)
library(dplyr)
library(pscl)
library(alr4)
disco <- discoveries
plot.ts(disco)
mean(disco)
m1 <- glm(disco ~ 1, family = poisson)
exp(m1$coefficients)
1-pchisq(deviance(m1),df.residual(m1))
t1 <- table(disco)
t1 <- as.data.frame(t1)
sum(t1[9:12,]$Freq)
t2 <- c(8,4)
t1 <- rbind(t1,t2)
t1 <- t1[-(9:12),]
expected <- c(dpois(0:7,3.1)*100, ppois(7,3.1,lower.tail = FALSE)*100)
te <- as.data.frame(expected)
colnames(te) <- "Freq"
te$disco <- c(0,1,2,3,4,5,6,7,8)
combined <- rbind(t1,te)
combined$source <- rep(c("observed","expected"), each = 9)
ggplot(combined, aes(x = disco, y = Freq, fill = source)) + geom_col(position = position_dodge())
